# Gitleaks configuration for comprehensive secret detection
# Generated by create-qa-architect

[extend]
# Use default gitleaks rules as base
useDefault = true

# Additional custom patterns for common secrets
[[rules]]
description = "JWT tokens"
id = "jwt-token"
regex = '''eyJ[A-Za-z0-9_/+-]{10,}={0,2}'''
tags = ["key", "JWT"]


[[rules]]
description = "Environment variable secrets"
id = "env-secret"
regex = '''(?i)(api_key|secret|password|token)\s*=\s*['""][^'"\s]{10,}['""]'''
tags = ["env", "secret"]

# Allowlist for test/example files (broad exclusion)
[allowlist]
description = "Test and example files"
regexes = ['''test_secret_.*|example_.*|dummy_.*|fake_.*|EXAMPLE_.*|your_.*_here|replace_with_.*|TODO:.*''']
paths = ['''(tests/|test/|__tests__/|examples/|docs/|\.md$|\.gitleaksignore$|private-key\.pem$|\.serena/|node_modules/|\.env.*\.local$|\.env\.local$)''']
